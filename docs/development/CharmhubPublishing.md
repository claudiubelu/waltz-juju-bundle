# FINOS Waltz Image Publishing Job on Charmhub

The ``Publish FINOS Waltz Images`` [action](../.github/workflows/publish_images.yaml) is configured to run periodically, and can be manually triggered by a project collaborator / owner, which will pull the tagged Waltz image releases and push them as new resource revisions in Charmhub and make new ``finos-waltz-k8s`` Charm releases using them.

This action requires the ``CHARMCRAFT_AUTH`` repository secret (Settings > Secrets > Actions > New repository secret) to be set up in the project in order to push the new charm revision. The token can be generated by running:

```bash
charmcraft login --export=secrets-waltz.auth --charm=finos-waltz-k8s \
      --bundle=finos-waltz-bundle --permission=package-view-revisions \
      --permission=package-manage --ttl=1576800
```

This token will have to be updated periodically since it has a certain time to live set.

The ``Publish Waltz Images`` action will trigger the ``Create FINOS Waltz release branch`` [action](../.github/workflows/create_release.yaml), which will create a new branch in the repository for the new release. This action can also be manually dispatched. But in order for this action chain to work, the ``GH_TOKEN`` repository secret needs to be added. The token can be [generated](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token) with the ``repo, workflow`` scopes.
